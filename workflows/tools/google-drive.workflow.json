{
  "name": "tool-google-drive",
  "nodes": [
    {
      "id": "manual-trigger",
      "name": "Tool Trigger",
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [
        200,
        300
      ]
    },
    {
      "id": "dispatch-operation",
      "name": "Dispatch Operation",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [
        420,
        300
      ],
      "parameters": {
        "functionCode": "const input = items[0]?.json || {};\nconst tool = input.tool || {};\nconst normalized = {\n  runId: input.runId || 'run-unknown',\n  stepId: input.stepId || ((tool.ref || tool.provider || 'tool') + '-step'),\n  tool: {\n    ref: tool.ref || 'google-drive',\n    provider: tool.provider || 'google-drive',\n    operation: tool.operation || ''\n  },\n  params: input.params || {},\n  context: input.context || {}\n};\nreturn [{ json: { toolInput: normalized } }];"
      }
    },
    {
      "id": "route-operation",
      "name": "Route Operation",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 1,
      "position": [
        650,
        300
      ],
      "parameters": {
        "dataType": "string",
        "value1": "={{$json.toolInput.tool.operation}}",
        "rules": [
          {
            "operation": "equal",
            "type": "string",
            "value": "file.upload"
          },
          {
            "operation": "equal",
            "type": "string",
            "value": "file.download"
          }
        ]
      }
    },
    {
      "id": "action-upload",
      "name": "Upload File",
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        900,
        240
      ],
      "parameters": {
        "operation": "createFromText",
        "content": "={{$json.toolInput.params.content || $json.toolInput.params.text || ''}}",
        "name": "={{$json.toolInput.params.path || $json.toolInput.params.name || 'GeneratedFile.txt'}}",
        "folderId": "={{$json.toolInput.params.folder || $json.toolInput.params.folderId || ''}}",
        "options": {}
      },
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "srne6dUOtNtqGhMU",
          "name": "Google Drive account"
        }
      }
    },
    {
      "id": "result-upload",
      "name": "Build Result (Upload)",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [
        1130,
        240
      ],
      "parameters": {
        "functionCode": "const toolInput = items[0].json.toolInput || {};\nconst data = $node[\"Upload File\"].json;\n\nreturn [{ json: { ok: true, data, error: null, meta: { tool: toolInput.tool, runId: toolInput.runId, stepId: toolInput.stepId } } }];"
      }
    },
    {
      "id": "action-download",
      "name": "Download File",
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        900,
        480
      ],
      "parameters": {
        "resource": "file",
        "operation": "download",
        "fileId": "={{$json.toolInput.params.file_id || $json.toolInput.params.fileId}}",
        "options": {
          "download": true
        }
      },
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "srne6dUOtNtqGhMU",
          "name": "Google Drive account"
        }
      }
    },
    {
      "id": "result-download",
      "name": "Build Result (Download)",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [
        1130,
        480
      ],
      "parameters": {
        "functionCode": "const toolInput = items[0].json.toolInput || {};\nconst data = $node[\"Download File\"].json || {};\nreturn [{ json: { ok: true, data, error: null, meta: { tool: toolInput.tool, runId: toolInput.runId, stepId: toolInput.stepId } } }];"
      }
    },
    {
      "id": "result-error",
      "name": "Build Result (Error)",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [
        900,
        640
      ],
      "parameters": {
        "functionCode": "const toolInput = items[0].json.toolInput || {};\nreturn [{ json: { ok: false, data: null, error: { code: 'UNKNOWN_OPERATION', message: 'Unsupported operation', details: { operation: toolInput.tool?.operation } }, meta: { tool: toolInput.tool, runId: toolInput.runId, stepId: toolInput.stepId } } }];"
      }
    }
  ],
  "connections": {
    "Tool Trigger": {
      "main": [
        [
          {
            "node": "Dispatch Operation",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Dispatch Operation": {
      "main": [
        [
          {
            "node": "Route Operation",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Route Operation": {
      "main": [
        [
          {
            "node": "Upload File",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Download File",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Build Result (Error)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Upload File": {
      "main": [
        [
          {
            "node": "Build Result (Upload)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Download File": {
      "main": [
        [
          {
            "node": "Build Result (Download)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "auto-generated"
}
